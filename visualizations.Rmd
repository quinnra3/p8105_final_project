---
title: "Visualizations"
output: html_document
date: '2023-12-01'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(knitr)
library(readr)
library(readxl)
library(tidyverse)
library(tidyr)
library(dplyr)
library(stringr)
library(scales)
library(lubridate)
```

Questions: wynter quinn laylah

1. What is the overall frequency of rat sightings? 
    a. Bar Chart or Histogram of rat frequency for each month
    
2. What is the distribution of rat sightings across different boroughs in NYC?
    a. Bar Chart comparing total number of rat sightings in each borough using facet wrap
    
3. Are there any seasonal trends or patterns in rat sightings?
    a. Line Graph to display the seasonal variation in rat sightings
    
4. Is there any correlation between monthly collection of garbage tonnages that the NYC Department of Sanitation collects and the prevalence of rat sightings?
    a. Scatter Plot of monthly garbage tonnage against number of rat sightings 
    b. Include line of best fit
    
5. Which borough has the most monthly reported rat sightings?
    a. Bar Chart 
    
 
    
# Loading Data Sets
```{r}
dsny_df <- read_csv("data/DSNY_Monthly_Tonnage_Data_20231108.csv") 

dsny_df = 
  dsny_df |> 
  janitor::clean_names() |> 
  separate(month, c("year", "month"), sep = " / ") |> 
  filter(year == "2023") |> 
  select(-communitydistrict, -resorganicstons, -schoolorganictons, -leavesorganictons, -xmastreetons)


rodent_inspec_df <- read_csv("data/Rodent Inspection Data - 2023.csv")

rodent_inspec_df = 
  rodent_inspec_df |> 
  janitor::clean_names() |> 
  select(-job_id, -job_ticket_or_work_order_id, -job_progress, -bbl, -house_number, -street_name, -block, -lot, -approved_date, -location, -community_board, -council_district, -census_tract, -bin, -nta)

rodent_tidy = 
  rodent_inspec_df |>
  mutate(inspection_date = parse_date_time(inspection_date, orders = "mdy HM"),
         day = day(inspection_date), 
         month = sprintf("%02d", month(inspection_date)), 
         year = year(inspection_date),  
         hour = hour(inspection_date),  
         minute = minute(inspection_date)) |> 
  select(-day, -hour, -minute, -boro_code)
  

total_rat_df = merge(dsny_df, rodent_inspec_df)

rat_merge_df = merge(dsny_df, rodent_tidy)
```


## Table 1
```{r}
## bar graph 

rat_table = 
  total_rat_df |> 
  data.frame(
    borough = c("Manhattan", "Brooklyn", "Bronx", "Queens", "Staten Island"),
    result = c("Passed", "Rat Activity", "Stoppage done", "Bait applied", "Cleanup done", "Failed for Other R", "Monitoring visit")
  ) 

rat_activity_counts <- total_rat_df |> 
  filter(result == "Rat Activity") |> 
  group_by(borough) |> 
  summarise(count = n())  
view(rat_activity_counts)

ggplot(rat_activity_counts, aes(x = borough, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Frequency of Rat Activity by Borough",
       x = "Borough",
       y = "Frequency") + 
  scale_y_continuous(labels = scales::comma_format(scale = 1e+0))
```


## Table 2

```{r}
rat_activity_counts =
  rat_merge_df |> 
  filter(result == "Rat Activity") |> 
  group_by(month) |> 
  summarise(count = n()) 

view(rat_activity_counts)

ggplot(rat_activity_counts, aes(x = month, y = count)) +
  geom_bar(stat = "identity", fill = "violet") +
  labs(title = "Frequency of Rat Activity by Month",
       x = "Month",
       y = "Frequency") + 
  scale_y_continuous(labels = scales::comma_format(scale = 1e+0))
```

